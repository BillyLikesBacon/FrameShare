<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport"/>
<meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<link href="/manifest.json" rel="manifest"/>
<meta content="#121212" name="theme-color"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<title>FrameShare</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  height: 100%;
  font-family: 'Share Tech Mono', monospace;
  background: #121212;
  color: #e0e0e0;
}
body {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: fixed;
  width: 100vw;
  height: 100vh;
  padding: 5px;
  box-sizing: border-box;
}
h1 {
  font-size: 3rem;
  margin-bottom: 5px;
  font-weight: 700;
  color: #f5f5f5;
}
button {
  font-family: 'Share Tech Mono', monospace;
  font-weight: 700;
  font-size: 1.25rem;
  padding: 5px 12px;
  border-radius: 16px;
  border: none;
  cursor: pointer;
  background: #444;
  color: #eee;
}
button:hover {
  background: #666;
}
input[type="text"] {
  font-size: 1.3rem;
  padding: 5px 10px;
  border-radius: 14px;
  border: 2px solid #666;
  background: #1e1e1e;
  color: #ddd;
}
#scorecards {
  width: 100%;
  max-width: 1250px;
  overflow-x: auto;
  padding-bottom: 10px;
}
.player-container {
  display: flex;
  align-items: stretch;
  margin-bottom: 50px;
  width: 100%;
  box-sizing: border-box;
}
table {
  border-collapse: separate;
  border-spacing: 0;
  background-color: #1c1c1c;
  color: #e0e0e0;
  width: 100%;
  min-width: 880px;
  table-layout: fixed;
  border-radius: 16px 0 0 16px;
}
th, td {
  border-left: 1.5px solid #333;
  border-top: 1.5px solid #333;
  padding: 8px 0;
  text-align: center;
  font-size: 1.2rem;
  font-weight: 600;
}
.total-container {
  width: 120px;
  background: #121212;
  color: #e0e0e0;
  font-weight: 900;
  font-size: 1.8rem;
  border-radius: 0 16px 16px 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 12px;
}
.player-container.active .total-container,
.player-container.active table,
.player-container.active table th,
.player-container.active table td,
.player-container.active table input {
  background-color: #fff !important;
  color: #000 !important;
}
#mobile-buttons button {
  font-size: 1.2rem;
  padding: 10px 16px;
  border-radius: 12px;
  background: #333;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
}
</style>
</head>
<body>
<h1>FrameShare</h1>
<button id="toggle-ui-btn" style="margin-bottom: 10px;">Hide UI</button>
<p>Type pins (0-9), 'X' for strike, '/' for spare. Players alternate turns each frame.</p>
<label style="flex-wrap: wrap; justify-content: center; width: 100%; gap: 10px;">
<span>Player Name:</span>
<input autocomplete="off" id="playerName" type="text"/>
<button onclick="addPlayer()">Add Player</button>
</label>
<div id="scorecards"></div>
<div id="connection-status">Connecting to PeerJS server...</div>
<div id="my-id">Your ID: ...</div>
<div id="connect-section">
<input autocomplete="off" id="connect-to-id" placeholder="Enter peer ID" type="text"/>
<button id="connect-btn">Connect</button>
</div>
<script src="https://cdn.jsdelivr.net/npm/peerjs@1.4.7/dist/peerjs.min.js"></script>
<script>
// ... All existing JavaScript remains the same except below:

// REMOVE: checkGameFinished, showFinishScreen, restart button logic, and patching addThrow
// CLEANED: No finish screen or related DOM/logic remains

class BowlingGame {
  constructor(name) {
    this.name = name;
    this.throws = [];
    this.currentThrow = 0;
    this.frame = 0;
    this.ballInFrame = 0;
    this.finished = false;
    this.createScorecard();
  }

  createScorecard() {
    const container = document.getElementById('scorecards');
    this.playerContainer = document.createElement('div');
    this.playerContainer.classList.add('player-container', 'active');
    this.table = document.createElement('table');
    this.table.classList.add('active');

    const header = document.createElement('tr');
    header.innerHTML = `<th colspan="21">${this.name}</th>`;
    this.table.appendChild(header);

    const framesRow = document.createElement('tr');
    for (let i = 1; i <= 10; i++) {
      const th = document.createElement('th');
      th.colSpan = i === 10 ? 3 : 2;
      th.textContent = `${i}`;
      framesRow.appendChild(th);
    }
    this.table.appendChild(framesRow);

    this.throwRow = document.createElement('tr');
    for (let i = 0; i < 21; i++) {
      const td = document.createElement('td');
      const input = document.createElement('input');
      input.readOnly = true;
      td.appendChild(input);
      this.throwRow.appendChild(td);
    }
    this.table.appendChild(this.throwRow);

    this.totalContainer = document.createElement('div');
    this.totalContainer.className = 'total-container';
    this.totalContainer.textContent = 'Total: 0';

    this.playerContainer.appendChild(this.table);
    this.playerContainer.appendChild(this.totalContainer);
    container.appendChild(this.playerContainer);
  }

  isStrike(i) { return this.throws[i] === 10; }
  isSpare(i) { return (this.throws[i] + this.throws[i+1]) === 10; }

  score() {
    let score = 0, i = 0;
    for (let f = 0; f < 10; f++) {
      if (this.isStrike(i)) {
        score += 10 + (this.throws[i+1] || 0) + (this.throws[i+2] || 0);
        i++;
      } else if (this.isSpare(i)) {
        score += 10 + (this.throws[i+2] || 0);
        i += 2;
      } else {
        score += (this.throws[i] || 0) + (this.throws[i+1] || 0);
        i += 2;
      }
    }
    return score;
  }

  canThrowPins(p) {
    if (this.finished) return false;
    if (this.frame < 9) {
      return (this.ballInFrame === 0 && p <= 10) ||
             (this.ballInFrame === 1 && p <= 10 - this.throws[this.currentThrow - 1]);
    } else {
      const prev = this.throws;
      if (this.ballInFrame === 0 || this.ballInFrame === 1) return p <= 10;
      if (this.ballInFrame === 2) {
        const last2 = prev[this.currentThrow - 2] + prev[this.currentThrow - 1];
        return last2 >= 10;
      }
    }
    return false;
  }

  addThrow(p) {
    if (!this.canThrowPins(p)) return false;
    this.throws[this.currentThrow++] = p;
    if (this.frame < 9) {
      if (this.ballInFrame === 0 && p === 10) {
        this.frame++;
      } else if (++this.ballInFrame === 2) {
        this.frame++;
        this.ballInFrame = 0;
      }
    } else if (++this.ballInFrame === 3 || 
      (this.ballInFrame === 2 && this.throws[this.currentThrow - 2] + p < 10)) {
      this.finished = true;
    }
    return true;
  }

  getDisplayScores() {
    const d = [], t = this.throws;
    let i = 0;
    for (let f = 0; f < 10; f++) {
      if (t[i] === undefined) { d.push(...(f === 9 ? ['','',''] : ['',''])); continue; }
      if (f < 9) {
        if (t[i] === 10) { d.push('X',''); i++; }
        else {
          d.push(t[i] || '-', (t[i]+t[i+1] === 10) ? '/' : t[i+1] || '-');
          i += 2;
        }
      } else {
        for (let j = 0; j < 3; j++) d.push(t[i] === 10 ? 'X' : t[i++] || '');
      }
    }
    return d;
  }

  updateUI() {
    const d = this.getDisplayScores();
    const inputs = this.throwRow.querySelectorAll('input');
    inputs.forEach((el, i) => el.value = d[i] || '');
    this.totalContainer.textContent = `Total: ${this.score()}`;
  }
}

const players = [];
let currentPlayerIndex = 0;

function addPlayer() {
  const input = document.getElementById('playerName');
  const name = input.value.trim();
  if (!name) return alert("Please enter a player name.");
  const game = new BowlingGame(name);
  players.push(game);
  input.value = '';
  updateCurrentPlayerHighlight();
  sendState();
}

function updateCurrentPlayerHighlight() {
  players.forEach((p, i) => {
    p.table.classList.toggle('active', i === currentPlayerIndex);
    p.playerContainer.classList.toggle('active', i === currentPlayerIndex);
  });
}

window.addEventListener('keydown', (e) => {
  if (!players.length) return;
  const key = e.key.toUpperCase();
  if (!['0','1','2','3','4','5','6','7','8','9','X','/'].includes(key)) return;
  const p = players[currentPlayerIndex];
  let pins = key === 'X' ? 10 : key === '/' ? 10 - (p.throws[p.currentThrow - 1] || 0) : parseInt(key);
  if (!p.addThrow(pins)) return alert("Invalid throw.");
  p.updateUI();
  if (p.ballInFrame === 0 || p.finished) {
    currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
    updateCurrentPlayerHighlight();
  }
  sendState();
  e.preventDefault();
});

// PeerJS and sync code remains unchanged...
// ...
</script>
<div id="mobile-buttons" style="display:none; position:fixed; bottom:10px; left:0; right:0; z-index:999; justify-content:center; flex-wrap:wrap; gap:8px; padding:10px;">
<button onclick="simulateKey('1')">1</button>
<button onclick="simulateKey('2')">2</button>
<button onclick="simulateKey('3')">3</button>
<button onclick="simulateKey('4')">4</button>
<button onclick="simulateKey('5')">5</button>
<button onclick="simulateKey('6')">6</button>
<button onclick="simulateKey('7')">7</button>
<button onclick="simulateKey('8')">8</button>
<button onclick="simulateKey('9')">9</button>
<button onclick="simulateKey('0')">0</button>
<button onclick="simulateKey('X')">X</button>
<button onclick="simulateKey('/')">/</button>
</div>
<script>
function simulateKey(key) {
  const event = new KeyboardEvent('keydown', { key, bubbles: true });
  window.dispatchEvent(event);
}
if (/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
  document.getElementById('mobile-buttons').style.display = 'flex';
}
</script>
</body>
</html>
